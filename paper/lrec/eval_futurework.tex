\section{Evaluation and Future Work}
\label{sec:eval}

We tested three grammars to find rules that cannot apply. The smallest grammar was Dutch\footnote{\url{https://svn.code.sf.net/p/apertium/svn/languages/apertium-nld/apertium-nld.nld.rlx}}, with 59 rules; second was Spanish\footnote{\url{https://svn.code.sf.net/p/apertium/svn/languages/apertium-spa/apertium-spa.spa.rlx}}with 279 rules, and the largest was Finnish\footnote{\url{https://github.com/flammie/omorfi/blob/master/src/vislcg3/omorfi.cg3}}, with 1185 rules.
For the smaller grammars, we were able to verify manually that the results are true.

\begin{table}[]
\centering
\begin{tabular}{|l|l|l|l|}
\hline
                      & \textsc{nld}  & \textsc{spa}  & \textsc{fin}  \\ \hline
Rules in grammar      & 59              & 279               & 1185     \\ \hline
Conflicts found       & 1               & ???               & ???    \\ \hline
Time: all rules       & 7s              & 3min 22s          & 3h 26min    \\ \hline
Time: last rule       & 4s              & 7s                & 3min 40s    \\ \hline
Time: longest rule    & ?s              & ?s                & ?min     \\ \hline

\end{tabular}
\caption{Results}
\label{table:res}
\end{table}

The first row shows the whole number of rules. For the Finnish grammar, we took only \textsc{remove} and \textsc{select} rules. The other two only contained those rules to start with.

We tested all three grammars if they contain non-applicable rules:
for each rule, apply all the preceding rules to the symbolic sentence, and then ask if that last rule can fire.
This test revealed problems in all grammars.
The Dutch grammar had the following rules in the given order, making the latter impossible to apply:

\begin{itemize}
\item[] 
\begin{verbatim}REMOVE adv IF (1 n|np) ;
REMOVE adv IF (-1 det) (0 adj) (1 n|np) ;
\end{verbatim}
\end{itemize}

The Spanish grammar had an erroneous set definition, where a word was required to have almost all POS tags at the same time. After fixing the set definition, our test didn't reveal other problems.
The program marked \todo{n} problem rules for the Finnish grammar, but we didn't have time to verify if they were genuinely problematic or if our program is at fault.
We suspect that at least part of is related to the length of the sentences---for a condition that states $n$ or more words to the left or right, we only create a word exactly $n$ words away.

As seen in table~\ref{table:res}, checking every rule in the Finnish grammar takes currently 3.5 hours.
A rule takes longer to run if it appears later in the rule sequence: 1000 previous rules is a larger SAT problem than 10 previous rules.
This can be seen from the time it took to compute the result for the last rule. For Finnish, the last rule took almost 4 minutes---if this was the average speed, the whole grammar would have taken 18 hours instead of 3.5.
We also measured the running times for the longest rules in the grammar.
\todo{find longest rule, change place of that rule, see what matters more. Promise: we can be smarter about SAT things.}


For future work, we will continue improving the performance, and make sure that the implementation for the basic rules is correct; for instance, fixing the earlier mentioned issue with non-exact position.
After this, we want to handle the full expressivity of CG-3, with \textsc{map}, \textsc{add} and \textsc{substitute} rules.

Independently of 
As another line of investigation, we want to detect more kinds of conflicts.
For instance, say we have the following rules:

\begin{itemize}
\item[] \texttt{REMOVE verb IF (-1C det) ;}
\item[] \texttt{REMOVE noun IF (-1C det) ;}
\end{itemize}

With our symbolic sentence, these rules will be no problem; after all, there can be something else in the target beside noun and a verb.
However, it is likely that the grammar writer actually means the following:

\begin{itemize}
\item[] \texttt{REMOVE verb IF (-1C det) (0 noun) ;}
\item[] \texttt{REMOVE noun IF (-1C det) (0 verb) ;}
\end{itemize}

In that case, those rules are contradictory, and we would like to find it out.

Compare with a corpus-based test: do we find the same problems?

Finally, we want to test the approach to other grammar formalisms.



% * Preliminary results
%  - dutch & spanish
%  - mention scalability
%  - talk about size of SAT problem -- give number of SAT clauses for the last rule in the biggest grammar I have

% * Future work
%  - analysing different grammar formalisms
%  - asking different questions
%  - restrict yourself to readings that are actually words